<!--
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<div>
  <!-- binding-mode -->
  <div class="row interpreter" style="margin-top: 5px;">
    <div class="col-md-6">
      <span>The interpreter will be instantiated</span>

      <span class="btn-group">
        <button type="button" class="btn btn-default btn-xs dropdown-toggle"
                data-toggle="dropdown"
                ng-disabled="$ctrl.isReadonly">
          <span ng-bind="$ctrl.getSessionUnitName()"></span>
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li>
            <a style="cursor:pointer" ng-click="$ctrl.setSessionUnit('shared', 'shared')">
              globally
            </a>
          </li>
          <li ng-if="!$ctrl.isAnonymousPrincipal()">
            <a style="cursor:pointer" ng-click="$ctrl.setSessionUnit('shared', 'scoped')">
              per user
            </a>
          </li>
          <li>
            <a style="cursor:pointer" ng-click="$ctrl.setSessionUnit('scoped', '')">
              per note
            </a>
          </li>
        </ul>
      </span>

      <span>in</span>

      <span class="btn-group">
        <button type="button" class="btn btn-default btn-xs dropdown-toggle"
                data-toggle="dropdown"
                ng-disabled="$ctrl.isReadonly || $ctrl.isGlobalSession()">
          <!-- selected option value for session mode -->
          <span ng-bind="$ctrl.getOptionTextForSelectedSessionMode()"></span>
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li>
            <a style="cursor:pointer"
               ng-if="$ctrl.isPerNoteSession()"
               uib-tooltip="Separate Interpreter instance for each note"
               ng-click="$ctrl.setPerNoteSessionMode('scoped')">
              scoped per note
            </a>
          </li>
          <li>
            <a style="cursor:pointer"
               ng-if="$ctrl.isPerNoteSession()"
               uib-tooltip="Separate Interpreter process for each note"
               ng-click="$ctrl.setPerNoteSessionMode('isolated')">
              isolated per note
            </a>
          </li>
          <li>
            <a style="cursor:pointer"
               ng-if="$ctrl.isPerUserSession()"
               uib-tooltip="Separate Interpreter instance for each user"
               ng-click="$ctrl.setPerUserSessionMode('scoped')">
              scoped per user
            </a>
          </li>
          <li>
            <a style="cursor:pointer"
               ng-if="$ctrl.isPerUserSession()"
               uib-tooltip="Separate Interpreter process for each user"
               ng-click="$ctrl.setPerUserSessionMode('isolated')">
              isolated per user
            </a>
          </li>
        </ul>
      </span>

      <span>process</span>

      <a class="fa fa-info-circle interpreter-binding-mode-info-link"
         aria-hidden="true"
         uib-tooltip="Can manage interpreter sessions differently by setting this option. Click this button to learn more"
         ng-href="{{$ctrl.getInterpreterBindingModeDocsLink()}}" target="_blank"></a>

      <span ng-if="$ctrl.isPerUserSession() && !$ctrl.isAnonymousPrincipal()">
        <span ng-if="$ctrl.isSharedPerNoteSession()">
          <button type="button" class="btn btn-default btn-xs"
                  ng-click="$ctrl.setPerNoteSessionMode('scoped')"
                  ng-disabled="$ctrl.isReadonly"
                  data-toggle="dropdown">
            <i class="fa fa-plus"></i>
          </button>
        </span>
      </span>
    </div>
  </div>

  <!-- `per user` + `per note` -->
  <div class="row interpreter"
       style="margin-top: 6px;"
       ng-if="$ctrl.usePerNoteWithPerUser()">
    <div class="col-md-12">
      <span>
        <span class="hidden-xs" style="padding-left: 190px;">and </span>
        <span class="visible-xs" style="padding-left: 0px;">and </span>

        <span class="btn-group">
          <button type="button" class="btn btn-default btn-xs dropdown-toggle"
                  data-toggle="dropdown"
                  ng-disabled="true">
            <span>per note</span>
            <span class="caret"></span>
          </button>
        </span>

        <span>in</span>

        <span class="btn-group">
          <button type="button" class="btn btn-default btn-xs dropdown-toggle"
                  data-toggle="dropdown"
                  ng-disabled="$ctrl.isReadonly">
            <span>{{$ctrl.getPerNoteSessionMode()}}</span>
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu">
            <li>
              <a style="cursor:pointer"
                uib-tooltip="Separate Interpreter instance for each note"
                ng-click="$ctrl.setPerNoteSessionMode('scoped')">
                scoped per note
              </a>
            </li>
            <li>
              <a style="cursor:pointer"
                uib-tooltip="Separate Interpreter process for each note"
                ng-click="$ctrl.setPerNoteSessionMode('isolated')">
                isolated per note
              </a>
            </li>
          </ul>
        </span>

        <span>process</span>

        <a class="fa fa-info-circle interpreter-binding-mode-info-link"
         aria-hidden="true"
         uib-tooltip="Can manage interpreter sessions differently by setting this option. Click this button to learn more"
         ng-href="{{$ctrl.getInterpreterBindingModeDocsLink()}}" target="_blank"></a>

        <button type="button" class="btn btn-default btn-xs"
                ng-disabled="$ctrl.isReadonly"
                ng-click="$ctrl.setPerNoteSessionMode('shared')"
                data-toggle="dropdown">
          <i class="fa fa-minus"></i>
        </button>
      </span>
    </div>
  </div>
  <!-- binding-mode: end -->

  <!-- user impersonation -->
  <div class="row interpreter" style="margin-top: 5px;"
       ng-show="$ctrl.showImpersonationCheckbox()">
    <div class="col-md-12">
      <div class="checkbox remove-margin-top-bottom">
        <span class="input-group" style="line-height:30px;">
          <label>
            <input type="checkbox" style="width:20px"
                   ng-model="$ctrl.setting.option.isUserImpersonate"
                   ng-change="$ctrl.validateUserImpersonateValue()"
                   ng-disabled="$ctrl.isReadonly" />
          User Impersonate
          </label>
        </span>
      </div>
    </div>
  </div>
  <!-- user impersonation: end -->

</div>
